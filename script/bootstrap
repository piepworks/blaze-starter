#!/bin/sh

# Get the name of the current folder.
raw_folder=${PWD##*/}
# Replace hypehens with underscores.
project_folder=${raw_folder//-/_}

# Create a virtual environment and get things installed.
python3 -m venv --prompt . .venv
.venv/bin/pip install -U pip setuptools wheel
source .venv/bin/activate
python -m pip install pip-tools
pip-compile
python -m pip install -r requirements.txt

# Name the Django project with the same name as our base folder.
django-admin startproject $project_folder .

# Create a "core" app.
cd $project_folder
../manage.py startapp core

next_steps="
# Next steps:
\n
- Add \`\"${project_folder}.core\",\` to the top of your \`INSTALLED_APPS\`.\n
- Add \`AUTH_USER_MODEL = \"core.User\"\` right before \`AUTH_PASSWORD_VALIDATORS = [\`.\n
"

if command -v gum &> /dev/null
then
  echo $next_steps | gum format
else
  echo $next_steps
fi
